/**
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *     http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// If the loader is already loaded, just stop.
if (!self.define) {
  let registry = {};

  // Used for `eval` and `importScripts` where we can't get script URL by other means.
  // In both cases, it's safe to use a global var because those functions are synchronous.
  let nextDefineUri;

  const singleRequire = (uri, parentUri) => {
    uri = new URL(uri + ".js", parentUri).href;
    return registry[uri] || (
      
        new Promise(resolve => {
          if ("document" in self) {
            const script = document.createElement("script");
            script.src = uri;
            script.onload = resolve;
            document.head.appendChild(script);
          } else {
            nextDefineUri = uri;
            importScripts(uri);
            resolve();
          }
        })
      
      .then(() => {
        let promise = registry[uri];
        if (!promise) {
          throw new Error(`Module ${uri} didnâ€™t register its module`);
        }
        return promise;
      })
    );
  };

  self.define = (depsNames, factory) => {
    const uri = nextDefineUri || ("document" in self ? document.currentScript.src : "") || location.href;
    if (registry[uri]) {
      // Module is already loading or loaded.
      return;
    }
    let exports = {};
    const require = depUri => singleRequire(depUri, uri);
    const specialDeps = {
      module: { uri },
      exports,
      require
    };
    registry[uri] = Promise.all(depsNames.map(
      depName => specialDeps[depName] || require(depName)
    )).then(deps => {
      factory(...deps);
      return exports;
    });
  };
}
define([],(function(){"use strict";
/**
     * @license
     * Copyright 2019 Google LLC
     * SPDX-License-Identifier: Apache-2.0
     */const e=Symbol("Comlink.proxy"),n=Symbol("Comlink.endpoint"),t=Symbol("Comlink.releaseProxy"),r=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),i=e=>"object"==typeof e&&null!==e||"function"==typeof e,a=new Map([["proxy",{canHandle:n=>i(n)&&n[e],serialize(e){const{port1:n,port2:t}=new MessageChannel;return s(e,n),[t,[t]]},deserialize(e){return e.start(),m(e,[],n);var n}}],["throw",{canHandle:e=>i(e)&&o in e,serialize({value:e}){let n;return n=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[n,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function s(n,t=globalThis,i=["*"]){t.addEventListener("message",(function a(c){if(!c||!c.data)return;if(!function(e,n){for(const t of e){if(n===t||"*"===t)return!0;if(t instanceof RegExp&&t.test(n))return!0}return!1}(i,c.origin))return void console.warn(`Invalid origin '${c.origin}' for comlink proxy`);const{id:l,type:f,path:p}=Object.assign({path:[]},c.data),m=(c.data.argumentList||[]).map(g);let y;try{const t=p.slice(0,-1).reduce(((e,n)=>e[n]),n),r=p.reduce(((e,n)=>e[n]),n);switch(f){case"GET":y=r;break;case"SET":t[p.slice(-1)[0]]=g(c.data.value),y=!0;break;case"APPLY":y=r.apply(t,m);break;case"CONSTRUCT":y=function(n){return Object.assign(n,{[e]:!0})}(new r(...m));break;case"ENDPOINT":{const{port1:e,port2:t}=new MessageChannel;s(n,t),y=function(e,n){return d.set(e,n),e}(e,[e])}break;case"RELEASE":y=void 0;break;default:return}}catch(e){y={value:e,[o]:0}}Promise.resolve(y).catch((e=>({value:e,[o]:0}))).then((e=>{const[o,i]=h(e);t.postMessage(Object.assign(Object.assign({},o),{id:l}),i),"RELEASE"===f&&(t.removeEventListener("message",a),u(t),r in n&&"function"==typeof n[r]&&n[r]())})).catch((e=>{const[n,r]=h({value:new TypeError("Unserializable return value"),[o]:0});t.postMessage(Object.assign(Object.assign({},n),{id:l}),r)}))})),t.start&&t.start()}function u(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function c(e){if(e)throw new Error("Proxy has been released and is not useable")}function l(e){return b(e,{type:"RELEASE"}).then((()=>{u(e)}))}const f=new WeakMap,p="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const n=(f.get(e)||0)-1;f.set(e,n),0===n&&l(e)}));function m(e,r=[],o=function(){}){let i=!1;const a=new Proxy(o,{get(n,o){if(c(i),o===t)return()=>{!function(e){p&&p.unregister(e)}(a),l(e),i=!0};if("then"===o){if(0===r.length)return{then:()=>a};const n=b(e,{type:"GET",path:r.map((e=>e.toString()))}).then(g);return n.then.bind(n)}return m(e,[...r,o])},set(n,t,o){c(i);const[a,s]=h(o);return b(e,{type:"SET",path:[...r,t].map((e=>e.toString())),value:a},s).then(g)},apply(t,o,a){c(i);const s=r[r.length-1];if(s===n)return b(e,{type:"ENDPOINT"}).then(g);if("bind"===s)return m(e,r.slice(0,-1));const[u,l]=y(a);return b(e,{type:"APPLY",path:r.map((e=>e.toString())),argumentList:u},l).then(g)},construct(n,t){c(i);const[o,a]=y(t);return b(e,{type:"CONSTRUCT",path:r.map((e=>e.toString())),argumentList:o},a).then(g)}});return function(e,n){const t=(f.get(n)||0)+1;f.set(n,t),p&&p.register(e,n,e)}(a,e),a}function y(e){const n=e.map(h);return[n.map((e=>e[0])),(t=n.map((e=>e[1])),Array.prototype.concat.apply([],t))];var t}const d=new WeakMap;function h(e){for(const[n,t]of a)if(t.canHandle(e)){const[r,o]=t.serialize(e);return[{type:"HANDLER",name:n,value:r},o]}return[{type:"RAW",value:e},d.get(e)||[]]}function g(e){switch(e.type){case"HANDLER":return a.get(e.name).deserialize(e.value);case"RAW":return e.value}}function b(e,n,t){return new Promise((r=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function n(t){t.data&&t.data.id&&t.data.id===o&&(e.removeEventListener("message",n),r(t.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:o},n),t)}))}var v,w=void 0!==w?w:{},_={};for(v in w)w.hasOwnProperty(v)&&(_[v]=w[v]);w.arguments=[],w.thisProgram="./this.program",w.quit=function(e,n){throw n},w.preRun=[],w.postRun=[];var E,A,S=!1,T=!1,M=!1,R=!1;if(w.ENVIRONMENT)if("WEB"===w.ENVIRONMENT)S=!0;else if("WORKER"===w.ENVIRONMENT)T=!0;else if("NODE"===w.ENVIRONMENT)M=!0;else{if("SHELL"!==w.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");R=!0}else S="object"==typeof window,T="function"==typeof importScripts,M="object"==typeof process&&"function"==typeof require&&!S&&!T,R=!S&&!M&&!T;M?(w.read=function(e,n){var t;return E||(E=require("fs")),A||(A=require("path")),e=A.normalize(e),t=E.readFileSync(e),n?t:t.toString()},w.readBinary=function(e){var n=w.read(e,!0);return n.buffer||(n=new Uint8Array(n)),L(n.buffer),n},process.argv.length>1&&(w.thisProgram=process.argv[1].replace(/\\/g,"/")),w.arguments=process.argv.slice(2),"undefined"!=typeof module&&(module.exports=w),process.on("uncaughtException",(function(e){if(!(e instanceof be))throw e})),process.on("unhandledRejection",(function(e,n){process.exit(1)})),w.inspect=function(){return"[Emscripten Module object]"}):R?("undefined"!=typeof read&&(w.read=function(e){return read(e)}),w.readBinary=function(e){var n;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(L("object"==typeof(n=read(e,"binary"))),n)},"undefined"!=typeof scriptArgs?w.arguments=scriptArgs:void 0!==arguments&&(w.arguments=arguments),"function"==typeof quit&&(w.quit=function(e,n){quit(e)})):(S||T)&&(w.read=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),n.responseText},T&&(w.readBinary=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),w.readAsync=function(e,n,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?n(r.response):t()},r.onerror=t,r.send(null)},w.setWindowTitle=function(e){document.title=e});for(v in w.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,w.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||w.print,w.print=w.print,w.printErr=w.printErr,_)_.hasOwnProperty(v)&&(w[v]=_[v]);_=void 0;function C(e,n){return n||(n=16),e=Math.ceil(e/n)*n}new Array(0);var N=0;function L(e,n){e||we("Assertion failed: "+n)}function k(e){var n=w["_"+e];return L(n,"Cannot call unknown function "+e+", make sure it is exported"),n}var O={stackSave:function(){ge()},stackRestore:function(){he()},arrayToC:function(e){var n=de(e.length);return function(e,n){B.set(e,n)}(e,n),n},stringToC:function(e){var n=0;if(null!=e&&0!==e){var t=1+(e.length<<2);(function(e,n,t){(function(e,n,t,r){if(!(r>0))return 0;for(var o=t,i=t+r-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(t>=i)break;n[t++]=s}else if(s<=2047){if(t+1>=i)break;n[t++]=192|s>>6,n[t++]=128|63&s}else if(s<=65535){if(t+2>=i)break;n[t++]=224|s>>12,n[t++]=128|s>>6&63,n[t++]=128|63&s}else if(s<=2097151){if(t+3>=i)break;n[t++]=240|s>>18,n[t++]=128|s>>12&63,n[t++]=128|s>>6&63,n[t++]=128|63&s}else if(s<=67108863){if(t+4>=i)break;n[t++]=248|s>>24,n[t++]=128|s>>18&63,n[t++]=128|s>>12&63,n[t++]=128|s>>6&63,n[t++]=128|63&s}else{if(t+5>=i)break;n[t++]=252|s>>30,n[t++]=128|s>>24&63,n[t++]=128|s>>18&63,n[t++]=128|s>>12&63,n[t++]=128|s>>6&63,n[t++]=128|63&s}}n[t]=0})(e,F,n,t)})(e,n=de(t),t)}return n}},P={string:O.stringToC,array:O.arrayToC};function x(e,n){if(0===n||!e)return"";for(var t,r=0,o=0;r|=t=F[e+o>>0],(0!=t||n)&&(o++,!n||o!=n););n||(n=o);var i="";if(r<128){for(var a,s=1024;n>0;)a=String.fromCharCode.apply(String,F.subarray(e,e+Math.min(n,s))),i=i?i+a:a,e+=s,n-=s;return i}return function(e){return function(e,n){var t=n;for(;e[t];)++t;if(t-n>16&&e.subarray&&I)return I.decode(e.subarray(n,t));for(var r,o,i,a,s,u="";;){if(!(r=e[n++]))return u;if(128&r)if(o=63&e[n++],192!=(224&r))if(i=63&e[n++],224==(240&r)?r=(15&r)<<12|o<<6|i:(a=63&e[n++],240==(248&r)?r=(7&r)<<18|o<<12|i<<6|a:(s=63&e[n++],r=248==(252&r)?(3&r)<<24|o<<18|i<<12|a<<6|s:(1&r)<<30|o<<24|i<<18|a<<12|s<<6|63&e[n++])),r<65536)u+=String.fromCharCode(r);else{var c=r-65536;u+=String.fromCharCode(55296|c>>10,56320|1023&c)}else u+=String.fromCharCode((31&r)<<6|o);else u+=String.fromCharCode(r)}}(F,e)}(e)}var I="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var W,B,F,z,D,j,H,V,U,q,K,G=65536;function X(){w.HEAP8=B=new Int8Array(W),w.HEAP16=z=new Int16Array(W),w.HEAP32=D=new Int32Array(W),w.HEAPU8=F=new Uint8Array(W),w.HEAPU16=new Uint16Array(W),w.HEAPU32=new Uint32Array(W),w.HEAPF32=new Float32Array(W),w.HEAPF64=new Float64Array(W)}function Y(){we("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+Z+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}j=U=0,H=!1;var J=w.TOTAL_STACK||5242880,Z=w.TOTAL_MEMORY||16777216;if(Z<J&&w.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+Z+"! (TOTAL_STACK="+J+")"),w.buffer?W=w.buffer:("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(w.wasmMemory=new WebAssembly.Memory({initial:Z/G,maximum:Z/G}),W=w.wasmMemory.buffer):W=new ArrayBuffer(Z),w.buffer=W),X(),D[0]=1668509029,z[1]=25459,115!==F[2]||99!==F[3])throw"Runtime error: expected the system to be little-endian!";function $(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var t=n.func;"number"==typeof t?void 0===n.arg?w.dynCall_v(t):w.dynCall_vi(t,n.arg):t(void 0===n.arg?null:n.arg)}else n()}}var Q=[],ee=[],ne=[],te=[],re=[],oe=!1;var ie=0,ae=null;w.preloadedImages={},w.preloadedAudios={};var se="data:application/octet-stream;base64,";function ue(e){return String.prototype.startsWith?e.startsWith(se):0===e.indexOf(se)}!function(){var e="a.out.wast",n="webcam-barcode-scanner.worker.wasm",t="a.out.temp.asm.js";"function"==typeof w.locateFile&&(ue(e)||(e=w.locateFile(e)),ue(n)||(n=w.locateFile(n)),ue(t)||(t=w.locateFile(t)));var r={global:null,env:null,asm2wasm:{"f64-rem":function(e,n){return e%n},debugger:function(){}},parent:w},o=null;function i(e){var n=w.buffer;e.byteLength<n.byteLength&&w.printErr("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var t,r=new Int8Array(n);new Int8Array(e).set(r),t=e,w.buffer=W=t,X()}function a(){try{if(w.wasmBinary)return new Uint8Array(w.wasmBinary);if(w.readBinary)return w.readBinary(n);throw"on the web, we need the wasm binary to be preloaded and set on Module['wasmBinary']. emcc.py will do that for you when generating HTML (but not JS)"}catch(e){we(e)}}function s(e,t,s){if("object"!=typeof WebAssembly)return w.printErr("no native wasm support detected"),!1;if(!(w.wasmMemory instanceof WebAssembly.Memory))return w.printErr("no native wasm Memory in use"),!1;function u(e,n){(o=e.exports).memory&&i(o.memory),w.asm=o,w.usingWasm=!0,function(e){if(ie--,w.monitorRunDependencies&&w.monitorRunDependencies(ie),0==ie&&ae){var n=ae;ae=null,n()}}()}if(t.memory=w.wasmMemory,r.global={NaN:NaN,Infinity:1/0},r["global.Math"]=Math,r.env=t,ie++,w.monitorRunDependencies&&w.monitorRunDependencies(ie),w.instantiateWasm)try{return w.instantiateWasm(r,u)}catch(e){return w.printErr("Module.instantiateWasm callback failed with error: "+e),!1}function c(e){u(e.instance,e.module)}function l(e){(w.wasmBinary||!S&&!T||"function"!=typeof fetch?new Promise((function(e,n){e(a())})):fetch(n,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+n+"'";return e.arrayBuffer()})).catch((function(){return a()}))).then((function(e){return WebAssembly.instantiate(e,r)})).then(e).catch((function(e){w.printErr("failed to asynchronously prepare wasm: "+e),we(e)}))}return w.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||ue(n)||"function"!=typeof fetch?l(c):WebAssembly.instantiateStreaming(fetch(n,{credentials:"same-origin"}),r).then(c).catch((function(e){w.printErr("wasm streaming compile failed: "+e),w.printErr("falling back to ArrayBuffer instantiation"),l(c)})),{}}w.asmPreload=w.asm;var u=w.reallocBuffer;w.reallocBuffer=function(e){return"asmjs"===c?u(e):function(e){var n,t,r=w.usingWasm?G:16777216;(n=e)%(t=r)>0&&(n+=t-n%t),e=n;var o=w.buffer.byteLength;if(w.usingWasm)try{return-1!==w.wasmMemory.grow((e-o)/65536)?w.buffer=w.wasmMemory.buffer:null}catch(e){return null}}(e)};var c="";w.asm=function(e,n,t){if(!n.table){var r=w.wasmTableSize;void 0===r&&(r=1024);var o=w.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?n.table=void 0!==o?new WebAssembly.Table({initial:r,maximum:o,element:"anyfunc"}):new WebAssembly.Table({initial:r,element:"anyfunc"}):n.table=new Array(r),w.wasmTable=n.table}var i;return n.memoryBase||(n.memoryBase=w.STATIC_BASE),n.tableBase||(n.tableBase=0),(i=s(0,n))||we("no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: https://github.com/kripken/emscripten/wiki/WebAssembly#binaryen-methods"),i}}(),j=138e3,ee.push();w.STATIC_BASE=1024,w.STATIC_BUMP=136976,j+=16;var ce={varargs:0,get:function(e){return ce.varargs+=4,D[ce.varargs-4>>2]},getStr:function(){return x(ce.get())},get64:function(){var e=ce.get(),n=ce.get();return L(e>=0?0===n:-1===n),e},getZero:function(){L(0===ce.get())}};function le(){we()}var fe=22;function pe(e){return w.___errno_location&&(D[w.___errno_location()>>2]=e),e}function me(){var e=me;return e.LLVM_SAVEDSTACKS||(e.LLVM_SAVEDSTACKS=[]),e.LLVM_SAVEDSTACKS.push(ge()),e.LLVM_SAVEDSTACKS.length-1}le=M?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof dateNow?dateNow:"object"==typeof self&&self.performance&&"function"==typeof self.performance.now?function(){return self.performance.now()}:"object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:Date.now,K=function(e){L(!H);var n=j;return j=j+e+15&-16,n}(4),V=U=C(j),q=C(V+J),D[K>>2]=q,H=!0,w.wasmTableSize=19,w.wasmMaxTableSize=19,w.asmGlobalArg={},w.asmLibraryArg={abort:we,enlargeMemory:function(){Y()},getTotalMemory:function(){return Z},abortOnCannotGrowMemory:Y,___assert_fail:function(e,n,t,r){we("Assertion failed: "+x(e)+", at: "+[n?x(n):"unknown filename",t,r?x(r):"unknown function"])},___setErrNo:pe,___syscall140:function(e,n){ce.varargs=n;try{var t=ce.getStreamFromFD(),r=(ce.get(),ce.get()),o=ce.get(),i=ce.get(),a=r;return FS.llseek(t,a,i),D[o>>2]=t.position,t.getdents&&0===a&&0===i&&(t.getdents=null),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||we(e),-e.errno}},___syscall146:function e(n,t){ce.varargs=t;try{var r=ce.get(),o=ce.get(),i=ce.get(),a=0;e.buffers||(e.buffers=[null,[],[]],e.printChar=function(n,t){var r=e.buffers[n];L(r),0===t||10===t?r.length=0:r.push(t)});for(var s=0;s<i;s++){for(var u=D[o+8*s>>2],c=D[o+(8*s+4)>>2],l=0;l<c;l++)e.printChar(r,F[u+l]);a+=c}return a}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||we(e),-e.errno}},___syscall54:function(e,n){ce.varargs=n;try{return 0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||we(e),-e.errno}},___syscall6:function(e,n){ce.varargs=n;try{var t=ce.getStreamFromFD();return FS.close(t),0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||we(e),-e.errno}},_clock_gettime:function(e,n){var t;if(0===e)t=Date.now();else{if(1!==e||!(M||"undefined"!=typeof dateNow||(S||T)&&self.performance&&self.performance.now))return pe(fe),-1;t=le()}return D[n>>2]=t/1e3|0,D[n+4>>2]=t%1e3*1e3*1e3|0,0},_emscripten_memcpy_big:function(e,n,t){return F.set(F.subarray(n,n+t),e),e},_js_output_result:function(e,n,t,r){const o=w.Pointer_stringify,i=new Int32Array(w.HEAP32.buffer,t,2*r),a=new Int32Array(i),s=w.processResult;if(null==s)throw new Error("No downstream processing function set");s(o(e),o(n),a)},_llvm_stackrestore:function(e){var n=me,t=n.LLVM_SAVEDSTACKS[e];n.LLVM_SAVEDSTACKS.splice(e,1),he(t)},_llvm_stacksave:me,DYNAMICTOP_PTR:K,STACKTOP:U};var ye=w.asm(w.asmGlobalArg,w.asmLibraryArg,W);w.asm=ye,w.___errno_location=function(){return w.asm.___errno_location.apply(null,arguments)},w._create_buffer=function(){return w.asm._create_buffer.apply(null,arguments)},w._destroy_buffer=function(){return w.asm._destroy_buffer.apply(null,arguments)},w._scan_image=function(){return w.asm._scan_image.apply(null,arguments)};var de=w.stackAlloc=function(){return w.asm.stackAlloc.apply(null,arguments)},he=w.stackRestore=function(){return w.asm.stackRestore.apply(null,arguments)},ge=w.stackSave=function(){return w.asm.stackSave.apply(null,arguments)};function be(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ve(e){function n(){w.calledRun||(w.calledRun=!0,N||(oe||(oe=!0,$(ee)),$(ne),w.onRuntimeInitialized&&w.onRuntimeInitialized(),function(){if(w.postRun)for("function"==typeof w.postRun&&(w.postRun=[w.postRun]);w.postRun.length;)e=w.postRun.shift(),re.unshift(e);var e;$(re)}()))}e=e||w.arguments,ie>0||(!function(){if(w.preRun)for("function"==typeof w.preRun&&(w.preRun=[w.preRun]);w.preRun.length;)e=w.preRun.shift(),Q.unshift(e);var e;$(Q)}(),ie>0||w.calledRun||(w.setStatus?(w.setStatus("Running..."),setTimeout((function(){setTimeout((function(){w.setStatus("")}),1),n()}),1)):n()))}function we(e){throw w.onAbort&&w.onAbort(e),void 0!==e?(w.print(e),w.printErr(e),e=JSON.stringify(e)):e="",N=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(w.dynCall_vi=function(){return w.asm.dynCall_vi.apply(null,arguments)},w.asm=ye,w.cwrap=function(e,n,t){t=t||[];var r=k(e),o=t.every((function(e){return"number"===e}));return"string"!==n&&o?r:function(){return function(e,n,t,r,o){var i=k(e),a=[],s=0;if(r)for(var u=0;u<r.length;u++){var c=P[t[u]];c?(0===s&&(s=ge()),a[u]=c(r[u])):a[u]=r[u]}var l=i.apply(null,a);return"string"===n?l=x(l):"boolean"===n&&(l=Boolean(l)),0!==s&&he(s),l}(e,n,t,arguments)}},w.Pointer_stringify=x,be.prototype=new Error,be.prototype.constructor=be,ae=function e(){w.calledRun||ve(),w.calledRun||(ae=e)},w.run=ve,w.exit=function(e,n){n&&w.noExitRuntime&&0===e||(w.noExitRuntime||(N=!0,U=undefined,$(te),w.onExit&&w.onExit(e)),M&&process.exit(e),w.quit(e,new be(e)))},w.abort=we,w.preInit)for("function"==typeof w.preInit&&(w.preInit=[w.preInit]);w.preInit.length>0;)w.preInit.pop()();function _e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ee(e,n,t,r,o,i){const a=(i-n)*(t-e)-(r-n)*(o-e);return a>0||!(a<0)}w.noExitRuntime=!0,ve();var Ae=function(e,n){const t=e[0][0],r=e[0][1],o=e[1][0],i=e[1][1],a=n[0][0],s=n[0][1],u=n[1][0],c=n[1][1];return Ee(t,r,a,s,u,c)!==Ee(o,i,a,s,u,c)&&Ee(t,r,o,i,a,s)!==Ee(t,r,o,i,u,c)};function Se(e,n){this._cells=[],this._cellSize=n,this._reverseCellSize=1/n;for(let n=0;n<e.length;n++){const t=e[n],r=this.coordToCellNum(t[0]),o=this.coordToCellNum(t[1]);if(this._cells[r])this._cells[r][o]?this._cells[r][o].push(t):this._cells[r][o]=[t];else{const e=[];e[o]=[t],this._cells[r]=e}}}function Te(e,n,t){return(n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0])}Se.prototype={cellPoints:function(e,n){return void 0!==this._cells[e]&&void 0!==this._cells[e][n]?this._cells[e][n]:[]},rangePoints:function(e){const n=this.coordToCellNum(e[0]),t=this.coordToCellNum(e[1]),r=this.coordToCellNum(e[2]),o=this.coordToCellNum(e[3]),i=[];for(let e=n;e<=r;e++)for(let n=t;n<=o;n++)for(let t=0;t<this.cellPoints(e,n).length;t++)i.push(this.cellPoints(e,n)[t]);return i},removePoint:function(e){const n=this.coordToCellNum(e[0]),t=this.coordToCellNum(e[1]),r=this._cells[n][t];let o;for(let n=0;n<r.length;n++)if(r[n][0]===e[0]&&r[n][1]===e[1]){o=n;break}return r.splice(o,1),r},trunc:Math.trunc||function(e){return e-e%1},coordToCellNum:function(e){return this.trunc(e*this._reverseCellSize)},extendBbox:function(e,n){return[e[0]-n*this._cellSize,e[1]-n*this._cellSize,e[2]+n*this._cellSize,e[3]+n*this._cellSize]}};var Me=function(e){const n=function(e){const n=[];for(let t=0;t<e.length;t++){for(;n.length>=2&&Te(n[n.length-2],n[n.length-1],e[t])<=0;)n.pop();n.push(e[t])}return n.pop(),n}(e),t=function(e){const n=e.reverse(),t=[];for(let e=0;e<n.length;e++){for(;t.length>=2&&Te(t[t.length-2],t[t.length-1],n[e])<=0;)t.pop();t.push(n[e])}return t.pop(),t}(e).concat(n);return t.push(e[0]),t};const Re=Ae,Ce=function(e,n){return new Se(e,n)},Ne={toXy:function(e,n){return void 0===n?e.slice():e.map((function(e){return new Function("pt","return [pt"+n[0]+",pt"+n[1]+"];")(e)}))},fromXy:function(e,n){return void 0===n?e.slice():e.map((function(e){return new Function("pt","const o = {}; o"+n[0]+"= pt[0]; o"+n[1]+"= pt[1]; return o;")(e)}))}},Le=Me;function ke(e,n){return Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)}function Oe(e,n,t){const r=[n[0]-e[0],n[1]-e[1]],o=[t[0]-e[0],t[1]-e[1]],i=ke(e,n),a=ke(e,t);return(r[0]*o[0]+r[1]*o[1])/Math.sqrt(i*a)}function Pe(e,n){for(let t=0;t<n.length-1;t++){const r=[n[t],n[t+1]];if(!(e[0][0]===r[0][0]&&e[0][1]===r[0][1]||e[0][0]===r[1][0]&&e[0][1]===r[1][1])&&Re(e,r))return!0}return!1}function xe(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function Ie(e,n,t){let r,o,i=null,a=Be,s=Be;for(let u=0;u<n.length;u++)r=Oe(e[0],e[1],n[u]),o=Oe(e[1],e[0],n[u]),r>a&&o>s&&!Pe([e[0],n[u]],t)&&!Pe([e[1],n[u]],t)&&(a=r,s=o,i=n[u]);return i}function We(e,n,t,r,o){let i=!1;for(let a=0;a<e.length-1;a++){const s=[e[a],e[a+1]],u=s[0][0]+","+s[0][1]+","+s[1][0]+","+s[1][1];if(ke(s[0],s[1])<n||o.has(u))continue;let c,l,f,p=0,m=xe(s);do{m=r.extendBbox(m,p),c=m[2]-m[0],l=m[3]-m[1],f=Ie(s,r.rangePoints(m),e),p++}while(null===f&&(t[0]>c||t[1]>l));c>=t[0]&&l>=t[1]&&o.add(u),null!==f&&(e.splice(a+1,0,f),r.removePoint(f),i=!0)}return i?We(e,n,t,r,o):e}const Be=Math.cos(90/(180/Math.PI)),Fe=.6;var ze=function(e,n,t){let r=n||20;const o=function(e){const n=[e[0]];let t=e[0];for(let r=1;r<e.length;r++){const o=e[r];t[0]===o[0]&&t[1]===o[1]||n.push(o),t=o}return n}(function(e){return e.sort((function(e,n){return e[0]-n[0]||e[1]-n[1]}))}(Ne.toXy(e,t)));if(o.length<4){const e=o.concat([o[0]]);return t?Ne.fromXy(e,t):e}const i=function(e){let n=1/0,t=1/0,r=-1/0,o=-1/0;for(let i=e.length-1;i>=0;i--)e[i][0]<n&&(n=e[i][0]),e[i][1]<t&&(t=e[i][1]),e[i][0]>r&&(r=e[i][0]),e[i][1]>o&&(o=e[i][1]);return[r-n,o-t]}(o),a=[i[0]*Fe,i[1]*Fe],s=Le(o),u=o.filter((function(e){return s.indexOf(e)<0})),c=Math.ceil(1/(o.length/(i[0]*i[1]))),l=We(s,Math.pow(r,2),a,Ce(u,c),new Set);return t?Ne.fromXy(l,t):l},De=_e(ze);let je,He;self.postMessage("ping"),w.onRuntimeInitialized=async()=>{je={scan_image:w.cwrap("scan_image","",["number","number","number"]),create_buffer:w.cwrap("create_buffer","number",["number","number"]),destroy_buffer:w.cwrap("destroy_buffer","",["number"])},w.processResult=(e,n,t)=>{He={data:n,symbol:e,polygon:t}}},s((async function(e,n,t,r){try{He=null;const o=je.create_buffer(e,n);if(w.HEAP8.set(t,o),je.scan_image(o,e,n),je.destroy_buffer(o),He){let e=[];if(r.includePolygon){let n=[];for(let e=0;e<He.polygon.length;e+=2)n.push([He.polygon[e],He.polygon[e+1]]);e=De(n,1/0).map((e=>({x:e[0],y:e[1]})))}return{data:He.data,symbol:He.symbol,polygon:e}}return He}catch(e){return null}}))}));
